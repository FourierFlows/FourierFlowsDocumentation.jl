<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Public · FourierFlows.jl</title><meta name="title" content="Public · FourierFlows.jl"/><meta property="og:title" content="Public · FourierFlows.jl"/><meta property="twitter:title" content="Public · FourierFlows.jl"/><meta name="description" content="Documentation for FourierFlows.jl."/><meta property="og:description" content="Documentation for FourierFlows.jl."/><meta property="twitter:description" content="Documentation for FourierFlows.jl."/><meta property="og:url" content="https://fourierflows.github.io/FourierFlowsDocumentation/stable/library/public/"/><meta property="twitter:url" content="https://fourierflows.github.io/FourierFlowsDocumentation/stable/library/public/"/><link rel="canonical" href="https://fourierflows.github.io/FourierFlowsDocumentation/stable/library/public/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FourierFlows.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation Instructions</a></li><li><a class="tocitem" href="../../basics/">Code Basics</a></li><li><a class="tocitem" href="../../grids/">Grids</a></li><li><a class="tocitem" href="../../aliasing/">Aliasing</a></li><li><a class="tocitem" href="../../problem/">Problem</a></li><li><a class="tocitem" href="../../timestepping/">Time stepping</a></li><li><a class="tocitem" href="../../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../output/">Output</a></li><li><a class="tocitem" href="../../gpu/">GPU</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../literated/OneDShallowWaterGeostrophicAdjustment/">Linear rotating shallow water dynamics</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s guide</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../outline/">Contents</a></li><li class="is-active"><a class="tocitem" href>Public</a><ul class="internal"><li><a class="tocitem" href="#FourierFlows"><span>FourierFlows</span></a></li><li><a class="tocitem" href="#Problem"><span>Problem</span></a></li><li><a class="tocitem" href="#Domain"><span>Domain</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li><li><a class="tocitem" href="#Diagnostics"><span>Diagnostics</span></a></li><li><a class="tocitem" href="#Output"><span>Output</span></a></li><li><a class="tocitem" href="#Timesteppers"><span>Timesteppers</span></a></li><li><a class="tocitem" href="#Diffusion-Testbed-Module"><span>Diffusion Testbed Module</span></a></li></ul></li><li><a class="tocitem" href="../internals/">Private</a></li><li><a class="tocitem" href="../function_index/">Function index</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Public</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Public</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FourierFlows/FourierFlows.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FourierFlows/FourierFlows.jl/blob/main/docs/src/library/public.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Public-Documentation"><a class="docs-heading-anchor" href="#Public-Documentation">Public Documentation</a><a id="Public-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Public-Documentation" title="Permalink"></a></h1><p>Documentation for <code>FourierFlows.jl</code>&#39;s public interface.</p><p>See the Internals section of the manual for internal package docs covering all submodules.</p><h2 id="FourierFlows"><a class="docs-heading-anchor" href="#FourierFlows">FourierFlows</a><a id="FourierFlows-1"></a><a class="docs-heading-anchor-permalink" href="#FourierFlows" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FourierFlows" href="#FourierFlows.FourierFlows"><code>FourierFlows.FourierFlows</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Main module for <code>FourierFlows.jl</code> – an ecosystem for solving partial differential equations  on periodic domains using Fourier-based pseudospectral methods.&quot;</p><p><strong>Exports</strong></p><ul><li><a href="#FourierFlows.AB3TimeStepper"><code>AB3TimeStepper</code></a></li><li><a href="#FourierFlows.AbstractGrid"><code>AbstractGrid</code></a></li><li><a href="#FourierFlows.AbstractParams"><code>AbstractParams</code></a></li><li><a href="#FourierFlows.AbstractTimeStepper"><code>AbstractTimeStepper</code></a></li><li><a href="#FourierFlows.AbstractVars"><code>AbstractVars</code></a></li><li><a href="#FourierFlows.CPU"><code>CPU</code></a></li><li><a href="#FourierFlows.Device"><code>Device</code></a></li><li><a href="#FourierFlows.Diagnostic"><code>Diagnostic</code></a></li><li><a href="#FourierFlows.ETDRK4TimeStepper"><code>ETDRK4TimeStepper</code></a></li><li><a href="#FourierFlows.FilteredAB3TimeStepper"><code>FilteredAB3TimeStepper</code></a></li><li><a href="#FourierFlows.FilteredETDRK4TimeStepper"><code>FilteredETDRK4TimeStepper</code></a></li><li><a href="#FourierFlows.FilteredForwardEulerTimeStepper"><code>FilteredForwardEulerTimeStepper</code></a></li><li><a href="#FourierFlows.FilteredLSRK54TimeStepper"><code>FilteredLSRK54TimeStepper</code></a></li><li><a href="#FourierFlows.FilteredRK4TimeStepper"><code>FilteredRK4TimeStepper</code></a></li><li><a href="#FourierFlows.ForwardEulerTimeStepper"><code>ForwardEulerTimeStepper</code></a></li><li><a href="#FourierFlows.GPU"><code>GPU</code></a></li><li><a href="#FourierFlows.LSRK54TimeStepper"><code>LSRK54TimeStepper</code></a></li><li><a href="#FourierFlows.OneDGrid"><code>OneDGrid</code></a></li><li><a href="#FourierFlows.Output"><code>Output</code></a></li><li><a href="#FourierFlows.RK4TimeStepper"><code>RK4TimeStepper</code></a></li><li><a href="#FourierFlows.ThreeDGrid"><code>ThreeDGrid</code></a></li><li><a href="#FourierFlows.TimeStepper"><code>TimeStepper</code></a></li><li><a href="#FourierFlows.TwoDGrid"><code>TwoDGrid</code></a></li><li><a href="@ref"><code>@createarrays</code></a></li><li><a href="#FourierFlows.cxtype-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:Number"><code>cxtype</code></a></li><li><a href="../../aliasing/#FourierFlows.dealias!"><code>dealias!</code></a></li><li><a href="../../gpu/#FourierFlows.device_array"><code>device_array</code></a></li><li><a href="#FourierFlows.@devzeros-Tuple{Any, Any, Any, Vararg{Any}}"><code>@devzeros</code></a></li><li><a href="@ref"><code>fft</code></a></li><li><a href="#FourierFlows.fltype-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>fltype</code></a></li><li><a href="#FourierFlows.gridpoints-Union{Tuple{OneDGrid{T, A}}, Tuple{A}, Tuple{T}} where {T, A}"><code>gridpoints</code></a></li><li><a href="@ref"><code>groupsize</code></a></li><li><a href="@ref"><code>ifft</code></a></li><li><a href="#FourierFlows.increment!-Tuple{Any}"><code>increment!</code></a></li><li><a href="#FourierFlows.innereltype-Tuple{Any}"><code>innereltype</code></a></li><li><a href="@ref"><code>irfft</code></a></li><li><a href="@ref"><code>resize!</code></a></li><li><a href="@ref"><code>rfft</code></a></li><li><a href="#FourierFlows.savediagnostic-Tuple{Any, Any, Any}"><code>savediagnostic</code></a></li><li><a href="#FourierFlows.saveoutput-Tuple{Any}"><code>saveoutput</code></a></li><li><a href="#FourierFlows.saveproblem-Tuple{Any, Any}"><code>saveproblem</code></a></li><li><a href="#FourierFlows.step_until!-Tuple{Any, Any}"><code>step_until!</code></a></li><li><a href="#FourierFlows.stepforward!-Tuple{FourierFlows.Problem, Any, Int64}"><code>stepforward!</code></a></li><li><a href="@ref"><code>supersize</code></a></li><li><a href="#FourierFlows.@superzeros-Tuple{Any, Any, Vararg{Any}}"><code>@superzeros</code></a></li><li><a href="#FourierFlows.superzeros-Tuple{Any, AbstractArray}"><code>superzeros</code></a></li><li><a href="#FourierFlows.update!-Tuple{Any, Any}"><code>update!</code></a></li><li><a href="#FourierFlows.@zeros-Tuple{Any, Any, Vararg{Any}}"><code>@zeros</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.AbstractGrid" href="#FourierFlows.AbstractGrid"><code>FourierFlows.AbstractGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract supertype for grids.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.AbstractParams" href="#FourierFlows.AbstractParams"><code>FourierFlows.AbstractParams</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract supertype for parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.AbstractTimeStepper" href="#FourierFlows.AbstractTimeStepper"><code>FourierFlows.AbstractTimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract supertype for timesteppers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.AbstractVars" href="#FourierFlows.AbstractVars"><code>FourierFlows.AbstractVars</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract supertype for variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.CPU" href="#FourierFlows.CPU"><code>FourierFlows.CPU</code></a> — <span class="docstring-category">Type</span></header><section><div><p>CPU device.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Device" href="#FourierFlows.Device"><code>FourierFlows.Device</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract supertype for supported devices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.GPU" href="#FourierFlows.GPU"><code>FourierFlows.GPU</code></a> — <span class="docstring-category">Type</span></header><section><div><p>GPU device.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/FourierFlows.jl#L100">source</a></section></article><h2 id="Problem"><a class="docs-heading-anchor" href="#Problem">Problem</a><a id="Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Problem" title="Permalink"></a></h2><h2 id="Domain"><a class="docs-heading-anchor" href="#Domain">Domain</a><a id="Domain-1"></a><a class="docs-heading-anchor-permalink" href="#Domain" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.OneDGrid" href="#FourierFlows.OneDGrid"><code>FourierFlows.OneDGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OneDGrid(dev::Device = CPU();
         nx, Lx,
         x0 = -Lx/2, nthreads = Sys.CPU_THREADS, effort = FFTW.MEASURE, 
         T = Float64, aliased_fraction = 1/3)</code></pre><p>Construct a <code>OneDGrid</code> on <code>dev</code>ice; by default on <code>CPU()</code>. Grid size is <code>Lx</code>, resolution is <code>nx</code>,  and leftmost position is <code>x0</code>. FFT plans are generated for <code>nthreads</code> CPUs using FFTW flag <code>effort</code>. The float type is <code>T</code>. The <code>aliased_fraction</code> keyword determines the highest wavenubers that are being zero-ed out by <code>dealias!</code> function; 1/3 is the nominal value for quadratic nonlinearities. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L49-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.OneDGrid" href="#FourierFlows.OneDGrid"><code>FourierFlows.OneDGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct OneDGrid{T&lt;:AbstractFloat, A, Tx, Tfft, Trfft, Talias} &lt;: AbstractGrid{T, A, Talias, D}</code></pre><p>A one-dimensional <code>grid</code>.</p><ul><li><p><code>device::Any</code>: device which the grid lives on</p></li><li><p><code>nx::Int64</code>: number of points in <span>$x$</span></p></li><li><p><code>nk::Int64</code>: number of wavenumbers in <span>$x$</span></p></li><li><p><code>nkr::Int64</code>: number of positive wavenumbers in <span>$x$</span> (real Fourier transforms)</p></li><li><p><code>dx::AbstractFloat</code>: grid spacing in <span>$x$</span></p></li><li><p><code>Lx::AbstractFloat</code>: domain extent in <span>$x$</span></p></li><li><p><code>x::Any</code>: range with <span>$x$</span>-grid-points</p></li><li><p><code>k::Any</code>: array with <span>$x$</span>-wavenumbers</p></li><li><p><code>kr::Any</code>: array with positive <span>$x$</span>-wavenumbers (real Fourier transforms)</p></li><li><p><code>invksq::Any</code>: array with inverse squared <span>$k$</span>-wavenumbers, <span>$1 / k²$</span></p></li><li><p><code>invkrsq::Any</code>: array with inverse squared <span>$kᵣ$</span>-wavenumbers, <span>$1 / kᵣ²$</span></p></li><li><p><code>fftplan::Any</code>: the FFT plan for complex-valued fields</p></li><li><p><code>rfftplan::Any</code>: the FFT plan for real-valued fields</p></li><li><p><code>aliased_fraction::AbstractFloat</code>: the fraction of wavenumbers that are aliased (e.g., 1/3 for quadradic nonlinearities)</p></li><li><p><code>kalias::Any</code>: range of the indices of aliased <span>$x$</span>-wavenumbers</p></li><li><p><code>kralias::Any</code>: range of the indices of aliased positive <span>$x$</span>-wavenumbers (real Fourier transforms)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L7-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.ThreeDGrid" href="#FourierFlows.ThreeDGrid"><code>FourierFlows.ThreeDGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ThreeDGrid(dev::Device=CPU(); nx, Lx, ny=nx, Ly=Lx, nz=nx, Lz=Lx,
           x0=-Lx/2, y0=-Ly/2, z0=-Lz/2,
           nthreads=Sys.CPU_THREADS, effort=FFTW.MEASURE, T=Float64,
           aliased_fraction=1/3)</code></pre><p>Construct a <code>ThreeDGrid</code> on <code>dev</code>ice; by default on <code>CPU()</code>. Grid size is <code>Lx</code>, <code>Ly</code>, <code>Lz</code>, resolution is <code>nx</code>, <code>ny</code>, <code>nz</code> and leftmost positions are <code>x0</code>, <code>y0</code>, <code>z0</code>. FFT plans are generated for <code>nthreads</code> CPUs using FFTW flag <code>effort</code>. The float type is <code>T</code>. The <code>aliased_fraction</code> keyword determines the highest wavenubers that are being zero-ed out by <code>dealias!</code> function; 1/3 is the nominal value for quadratic nonlinearities. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L299-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.ThreeDGrid" href="#FourierFlows.ThreeDGrid"><code>FourierFlows.ThreeDGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ThreeDGrid{T&lt;:AbstractFloat, Tk, Tx, Tfft, Trfft, Talias} &lt;: AbstractGrid{T, Tk, Talias}</code></pre><p>A three-dimensional <code>grid</code>.</p><ul><li><p><code>device::Any</code>: device which the grid lives on</p></li><li><p><code>nx::Int64</code>: number of points in <span>$x$</span></p></li><li><p><code>ny::Int64</code>: number of points in <span>$y$</span></p></li><li><p><code>nz::Int64</code>: number of points in <span>$z$</span></p></li><li><p><code>nk::Int64</code>: number of wavenumbers in <span>$x$</span></p></li><li><p><code>nl::Int64</code>: number of wavenumbers in <span>$y$</span></p></li><li><p><code>nm::Int64</code>: number of wavenumbers in <span>$z$</span></p></li><li><p><code>nkr::Int64</code>: number of positive wavenumers in <span>$x$</span> (real Fourier transforms)</p></li><li><p><code>dx::AbstractFloat</code>: grid spacing in <span>$x$</span></p></li><li><p><code>dy::AbstractFloat</code>: grid spacing in <span>$y$</span></p></li><li><p><code>dz::AbstractFloat</code>: grid spacing in <span>$z$</span></p></li><li><p><code>Lx::AbstractFloat</code>: domain extent in <span>$x$</span></p></li><li><p><code>Ly::AbstractFloat</code>: domain extent in <span>$y$</span></p></li><li><p><code>Lz::AbstractFloat</code>: domain extent in <span>$z$</span></p></li><li><p><code>x::Any</code>: range with <span>$x$</span>-grid-points</p></li><li><p><code>y::Any</code>: range with <span>$y$</span>-grid-points</p></li><li><p><code>z::Any</code>: range with <span>$z$</span>-grid-points</p></li><li><p><code>k::Any</code>: array with <span>$x$</span>-wavenumbers</p></li><li><p><code>l::Any</code>: array with <span>$y$</span>-wavenumbers</p></li><li><p><code>m::Any</code>: array with <span>$z$</span>-wavenumbers</p></li><li><p><code>kr::Any</code>: array with positive <span>$x$</span>-wavenumbers (real Fourier transforms)</p></li><li><p><code>Ksq::Any</code>: array with squared total wavenumbers, <span>$k² + l² + m²$</span></p></li><li><p><code>invKsq::Any</code>: array with inverse squared total wavenumbers, <span>$1 / (k² + l² + m²)$</span></p></li><li><p><code>Krsq::Any</code>: array with squared total wavenumbers for real Fourier transforms, <span>$kᵣ² + l² + m²$</span></p></li><li><p><code>invKrsq::Any</code>: array with inverse squared total wavenumbers for real Fourier transforms, <span>$1 / (kᵣ² + l² + m²)$</span></p></li><li><p><code>fftplan::Any</code>: the FFT plan for complex-valued fields</p></li><li><p><code>rfftplan::Any</code>: the FFT plan for real-valued fields</p></li><li><p><code>aliased_fraction::AbstractFloat</code>: the fraction of wavenumbers that are aliased (e.g., 1/3 for quadradic nonlinearities)</p></li><li><p><code>kalias::Any</code>: range of the indices of aliased <span>$x$</span>-wavenumbers</p></li><li><p><code>kralias::Any</code>: range of the indices of aliased positive <span>$x$</span>-wavenumbers (real Fourier transforms)</p></li><li><p><code>lalias::Any</code>: range of the indices of aliased <span>$y$</span>-wavenumbers</p></li><li><p><code>malias::Any</code>: range of the indices of aliased <span>$m$</span>-wavenumbers</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L225-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.TwoDGrid" href="#FourierFlows.TwoDGrid"><code>FourierFlows.TwoDGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TwoDGrid(dev::Device=CPU(); nx, Lx, ny=nx, Ly=Lx,
         x0=-Lx/2, y0=-Ly/2, nthreads=Sys.CPU_THREADS, effort=FFTW.MEASURE,
         T=Float64, aliased_fraction=1/3)</code></pre><p>Construct a <code>TwoDGrid</code> on <code>dev</code>ice; by default on <code>CPU()</code>. Grid size is <code>Lx</code>, <code>Ly</code>, resolution is <code>nx</code>, <code>ny</code>, and leftmost positions are <code>x0</code>, <code>y0</code>. FFT plans are generated for <code>nthreads</code> CPUs using FFTW flag <code>effort</code>. The float type is <code>T</code>. The <code>aliased_fraction</code> keyword determines the highest wavenubers that are being zero-ed out by <code>dealias!</code> function; 1/3 is the nominal value for quadratic nonlinearities. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L164-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.TwoDGrid" href="#FourierFlows.TwoDGrid"><code>FourierFlows.TwoDGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct TwoDGrid{T&lt;:AbstractFloat, A, Tx, Tfft, Trfft, Talias, D} &lt;: AbstractGrid{T, Tk, Talias, D}</code></pre><p>A two-dimensional <code>grid</code>.</p><ul><li><p><code>device::Any</code>: device which the grid lives on</p></li><li><p><code>nx::Int64</code>: number of points in <span>$x$</span></p></li><li><p><code>ny::Int64</code>: number of points in <span>$y$</span></p></li><li><p><code>nk::Int64</code>: number of wavenumbers in <span>$x$</span></p></li><li><p><code>nl::Int64</code>: number of wavenumbers in <span>$y$</span></p></li><li><p><code>nkr::Int64</code>: number of positive wavenumers in <span>$x$</span> (real Fourier transforms)</p></li><li><p><code>dx::AbstractFloat</code>: grid spacing in <span>$x$</span></p></li><li><p><code>dy::AbstractFloat</code>: grid spacing in <span>$y$</span></p></li><li><p><code>Lx::AbstractFloat</code>: domain extent in <span>$x$</span></p></li><li><p><code>Ly::AbstractFloat</code>: domain extent in <span>$y$</span></p></li><li><p><code>x::Any</code>: range with <span>$x$</span>-grid-points</p></li><li><p><code>y::Any</code>: range with <span>$y$</span>-grid-points</p></li><li><p><code>k::Any</code>: array with <span>$x$</span>-wavenumbers</p></li><li><p><code>l::Any</code>: array with <span>$y$</span>-wavenumbers</p></li><li><p><code>kr::Any</code>: array with positive <span>$x$</span>-wavenumbers (real Fourier transforms)</p></li><li><p><code>Ksq::Any</code>: array with squared total wavenumbers, <span>$k² + l²$</span></p></li><li><p><code>invKsq::Any</code>: array with inverse squared total wavenumbers, <span>$1 / (k² + l²)$</span></p></li><li><p><code>Krsq::Any</code>: array with squared total wavenumbers for real Fourier transforms, <span>$kᵣ² + l²$</span></p></li><li><p><code>invKrsq::Any</code>: array with inverse squared total wavenumbers for real Fourier transforms, <span>$1 / (kᵣ² + l²)$</span></p></li><li><p><code>fftplan::Any</code>: the FFT plan for complex-valued fields</p></li><li><p><code>rfftplan::Any</code>: the FFT plan for real-valued fields</p></li><li><p><code>aliased_fraction::AbstractFloat</code>: the fraction of wavenumbers that are aliased (e.g., 1/3 for quadradic nonlinearities)</p></li><li><p><code>kalias::Any</code>: range of the indices of aliased <span>$x$</span>-wavenumbers</p></li><li><p><code>kralias::Any</code>: range of the indices of aliased positive <span>$x$</span>-wavenumbers (real Fourier transforms)</p></li><li><p><code>lalias::Any</code>: range of the indices of aliased <span>$y$</span>-wavenumbers</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L104-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.dealias!-Tuple{Any, Any}" href="#FourierFlows.dealias!-Tuple{Any, Any}"><code>FourierFlows.dealias!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dealias!(fh, grid)</code></pre><p>Dealias array <code>fh</code> on the <code>grid</code> based on the <code>grids</code>&#39;s <code>aliased_fraction</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L423-L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.gridpoints-Union{Tuple{OneDGrid{T, A}}, Tuple{A}, Tuple{T}} where {T, A}" href="#FourierFlows.gridpoints-Union{Tuple{OneDGrid{T, A}}, Tuple{A}, Tuple{T}} where {T, A}"><code>FourierFlows.gridpoints</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridpoints(grid::OneDDGrid)
gridpoints(grid::TwoDGrid)
gridpoints(grid::ThreeDGrid)</code></pre><p>Return the collocation points of the <code>grid</code> in 1D (<code>X</code>),  2D (<code>X, Y</code>) or 3D arrays (<code>X, Y, Z</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/domains.jl#L372-L378">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.cxtype-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:Number" href="#FourierFlows.cxtype-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:Number"><code>FourierFlows.cxtype</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cxtype(T)</code></pre><p>Returns <code>T</code> when <code>T</code> is <code>Complex</code>, or <code>Complex{T}</code> when <code>T</code> is <code>Real</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L13-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.device_array-Tuple{AbstractGrid}" href="#FourierFlows.device_array-Tuple{AbstractGrid}"><code>FourierFlows.device_array</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">device_array(grid::AbstractGrid)</code></pre><p>Return the proper array type according to the <code>grid</code>&#39;s <code>device</code>, i.e., <code>Array</code> for CPU and <code>CuArray</code> for GPU.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L334-L339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.device_array-Tuple{CPU}" href="#FourierFlows.device_array-Tuple{CPU}"><code>FourierFlows.device_array</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">device_array(device::Device)
device_array(device::Device, T, dim)</code></pre><p>Return the proper array type according to the <code>device</code>, i.e., <code>Array</code> for CPU and <code>CuArray</code> for GPU.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L322-L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.fltype-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:AbstractFloat" href="#FourierFlows.fltype-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>FourierFlows.fltype</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fltype(T)</code></pre><p>Returns <code>T</code> when <code>T&lt;:AbstractFloat</code> or <code>Tf</code> when <code>T&lt;:Complex{Tf}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.innereltype-Tuple{Any}" href="#FourierFlows.innereltype-Tuple{Any}"><code>FourierFlows.innereltype</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">innereltype(x)</code></pre><p>Recursively determine the &#39;innermost&#39; type in by the collection <code>x</code> (which may be, for example, a collection of a collection).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.superzeros-Tuple{Any, AbstractArray}" href="#FourierFlows.superzeros-Tuple{Any, AbstractArray}"><code>FourierFlows.superzeros</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">superzeros(T, A)</code></pre><p>Returns an array like <code>A</code>, but full of zeros. If <code>innereltype(A)</code> can be promoted to <code>T</code>, then the innermost elements of the array will have type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L30-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.@devzeros-Tuple{Any, Any, Any, Vararg{Any}}" href="#FourierFlows.@devzeros-Tuple{Any, Any, Any, Vararg{Any}}"><code>FourierFlows.@devzeros</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@devzeros dev T dims a b c...</code></pre><p>Create arrays of all zeros with element type <code>T</code>, size <code>dims</code>, and global names <code>a</code>, <code>b</code>, <code>c</code> (for example) on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L83-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.@superzeros-Tuple{Any, Any, Vararg{Any}}" href="#FourierFlows.@superzeros-Tuple{Any, Any, Vararg{Any}}"><code>FourierFlows.@superzeros</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@superzeros T a b c d...
@superzeros T dims b c d...</code></pre><p>Generate arrays <code>b, c, d...</code> with the super-dimensions of <code>a</code> and innereltype <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L42-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.@zeros-Tuple{Any, Any, Vararg{Any}}" href="#FourierFlows.@zeros-Tuple{Any, Any, Vararg{Any}}"><code>FourierFlows.@zeros</code></a> — <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@zeros T dims a b c...</code></pre><p>Create arrays of all zeros with element type <code>T</code>, size <code>dims</code>, and global names <code>a</code>, <code>b</code>, <code>c</code> (for example). An arbitrary number of arrays may be created.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/utils.jl#L66-L71">source</a></section></article><h2 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Diagnostic" href="#FourierFlows.Diagnostic"><code>FourierFlows.Diagnostic</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Diagnostic{T, N} &lt;: AbstractDiagnostic</code></pre><p>A diagnostic that includes <code>N</code> elements of type <code>T</code>.</p><ul><li><p><code>calc::Function</code>: function that returns the diagnostic via <code>calc(prob)</code></p></li><li><p><code>prob::FourierFlows.Problem</code>: the relevant problem for this diagnostic</p></li><li><p><code>data::Vector</code>: vector where the diagnostic time-series is saved</p></li><li><p><code>t::Vector{Float64}</code>: vector with the times for which the diagnostic was saved</p></li><li><p><code>steps::Vector{Int64}</code>: vector with the problem&#39;s <code>step</code> for which the diagnostic was saved</p></li><li><p><code>freq::Int64</code>: integer denoting how often (every how many <code>problem.step</code>s) to save the diagnostic</p></li><li><p><code>i::Int64</code>: integer denoting how many times the <code>diagnostic.data</code> was updated</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diagnostics.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Diagnostic-Tuple{Any, Any}" href="#FourierFlows.Diagnostic-Tuple{Any, Any}"><code>FourierFlows.Diagnostic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Diagnostic(calc, prob; freq=1, nsteps=100, ndata=ceil(Int, (nsteps+1)/freq))</code></pre><p>Construct a diagnostic that stores the result of <code>calc(prob)</code> with frequency <code>freq</code>.</p><p><strong>Keywords</strong></p><ul><li><code>freq</code>: Diagnostic is saved every <code>freq</code> steps.</li><li><code>nsteps</code>: The total number of steps in problem.</li><li><code>ndata</code>: The number of diagnostics to be saved.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diagnostics.jl#L25-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.increment!-Tuple{Any}" href="#FourierFlows.increment!-Tuple{Any}"><code>FourierFlows.increment!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">increment!(diag)</code></pre><p>Increment the Diagnostic <code>diag</code>, or an array of Diagnostics <code>diags</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diagnostics.jl#L87-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.update!-Tuple{Any, Any}" href="#FourierFlows.update!-Tuple{Any, Any}"><code>FourierFlows.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update!(diag)</code></pre><p>Update <code>diag</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diagnostics.jl#L71-L75">source</a></section></article><h2 id="Output"><a class="docs-heading-anchor" href="#Output">Output</a><a id="Output-1"></a><a class="docs-heading-anchor-permalink" href="#Output" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Output" href="#FourierFlows.Output"><code>FourierFlows.Output</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Output</code></pre><p>The composite type for output.</p><ul><li><p><code>prob::FourierFlows.Problem</code>: the relevant problem for the output</p></li><li><p><code>path::String</code>: the path for the output file</p></li><li><p><code>fields::Dict{Symbol, Function}</code>: the fields to be saved; the relevant problem for this diagnostic</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/output.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Output-Tuple{Any, Any, Dict{Symbol, Function}}" href="#FourierFlows.Output-Tuple{Any, Any, Dict{Symbol, Function}}"><code>FourierFlows.Output</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Output(prob, filename, fieldtuples...)</code></pre><p>Define output for <code>prob</code> with fields and functions that calculate the output in the list of tuples <code>fieldtuples = (fldname, func)...</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/output.jl#L16-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.savediagnostic-Tuple{Any, Any, Any}" href="#FourierFlows.savediagnostic-Tuple{Any, Any, Any}"><code>FourierFlows.savediagnostic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">savediagnostic(diagnostic, diagname, filename)</code></pre><p>Save <code>diagnostic</code> to <code>filename</code> under name <code>diagname</code>. Only the computed diagnostic is saved, that is, everything up to diagnostic&#39;s iteration <code>diagnostic.i</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/output.jl#L147-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.saveoutput-Tuple{Any}" href="#FourierFlows.saveoutput-Tuple{Any}"><code>FourierFlows.saveoutput</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saveoutput(out)</code></pre><p>Save the fields in <code>out.fields</code> to <code>out.path</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/output.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.saveproblem-Tuple{Any, Any}" href="#FourierFlows.saveproblem-Tuple{Any, Any}"><code>FourierFlows.saveproblem</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saveproblem(prob, filename)</code></pre><p>Save certain aspects of a problem <code>prob</code> to <code>filename</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/output.jl#L129-L133">source</a></section></article><h2 id="Timesteppers"><a class="docs-heading-anchor" href="#Timesteppers">Timesteppers</a><a id="Timesteppers-1"></a><a class="docs-heading-anchor-permalink" href="#Timesteppers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.AB3TimeStepper" href="#FourierFlows.AB3TimeStepper"><code>FourierFlows.AB3TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AB3TimeStepper(equation::Equation, dev::Device=CPU())</code></pre><p>Construct a 3rd order Adams-Bashforth timestepper for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L592-L596">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.AB3TimeStepper" href="#FourierFlows.AB3TimeStepper"><code>FourierFlows.AB3TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct AB3TimeStepper{T} &lt;: AbstractTimeStepper{T}</code></pre><p>A 3rd-order Adams-Bashforth timestepper for time-stepping <code>∂u/∂t = RHS(u, t)</code> via:</p><pre><code class="language-julia hljs">uⁿ⁺¹ = uⁿ + dt/12 * (23 * RHS(uⁿ, tⁿ) - 16 * RHS(uⁿ⁻¹, tⁿ⁻¹) + 5 * RHS(uⁿ⁻², tⁿ⁻²))</code></pre><p>Adams-Bashforth is a multistep method, i.e., it not only requires information from the <code>n</code>-th time-step (<code>uⁿ</code>) but also from the previous two timesteps (<code>uⁿ⁻¹</code> and <code>uⁿ⁻²</code>). For the first two timesteps, it falls back to a forward Euler timestepping scheme:</p><pre><code class="language-julia hljs">uⁿ⁺¹ = uⁿ + dt * RHS(uⁿ, tⁿ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L569-L585">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.ETDRK4TimeStepper" href="#FourierFlows.ETDRK4TimeStepper"><code>FourierFlows.ETDRK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ETDRK4TimeStepper(equation::Equation, dt, dev::Device=CPU())</code></pre><p>Construct a 4th-order exponential-time-differencing Runge-Kutta timestepper with timestep <code>dt</code> for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L450-L455">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.ETDRK4TimeStepper" href="#FourierFlows.ETDRK4TimeStepper"><code>FourierFlows.ETDRK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ETDRK4TimeStepper{T,TL} &lt;: AbstractTimeStepper{T}</code></pre><p>A 4th-order exponential-time-differencing Runge-Kutta timestepper for time-stepping <code>∂u/∂t = L * u + N(u)</code>. The scheme treats the linear term <code>L</code> exactly while for the nonlinear terms <code>N(u)</code> it uses a 4th-order Runge-Kutta scheme (<a href="#FourierFlows.RK4TimeStepper"><code>RK4TimeStepper</code></a>). That is,</p><pre><code class="language-julia hljs">uⁿ⁺¹ = exp(L * dt) * uⁿ + RK4(N(uⁿ))</code></pre><p>For more info refer to <a href="../../references/#Kassam-Trefethen-2005">[2]</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L420-L433">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredAB3TimeStepper" href="#FourierFlows.FilteredAB3TimeStepper"><code>FourierFlows.FilteredAB3TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredAB3TimeStepper(equation::Equation, dev::Device=CPU(); filterkwargs...)</code></pre><p>Construct a 3rd order Adams-Bashforth timestepper with spectral filtering for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L616-L620">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredAB3TimeStepper" href="#FourierFlows.FilteredAB3TimeStepper"><code>FourierFlows.FilteredAB3TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FilteredAB3TimeStepper{T} &lt;: AbstractTimeStepper{T}</code></pre><p>A 3rd order Adams-Bashforth timestepper with spectral filtering. See <a href="#FourierFlows.AB3TimeStepper"><code>AB3TimeStepper</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L604-L608">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredETDRK4TimeStepper" href="#FourierFlows.FilteredETDRK4TimeStepper"><code>FourierFlows.FilteredETDRK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredETDRK4TimeStepper(equation, dt; filterkwargs...)</code></pre><p>Construct a 4th-order exponential-time-differencing Runge-Kutta timestepper with timestep <code>dt</code> and  spectral filtering for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L488-L493">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredETDRK4TimeStepper" href="#FourierFlows.FilteredETDRK4TimeStepper"><code>FourierFlows.FilteredETDRK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredETDRK4TimeStepper{T,TL,Tf} &lt;: AbstractTimeStepper{T}</code></pre><p>A 4th-order exponential-time-differencing Runge-Kutta timestepper with spectral filtering. See <a href="#FourierFlows.ETDRK4TimeStepper"><code>ETDRK4TimeStepper</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L465-L470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredForwardEulerTimeStepper" href="#FourierFlows.FilteredForwardEulerTimeStepper"><code>FourierFlows.FilteredForwardEulerTimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredForwardEulerTimeStepper(equation, dev; filterkwargs...)</code></pre><p>Construct a Forward Euler timestepper with spectral filtering for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L131-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredForwardEulerTimeStepper" href="#FourierFlows.FilteredForwardEulerTimeStepper"><code>FourierFlows.FilteredForwardEulerTimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FilteredForwardEulerTimeStepper{T,Tf} &lt;: AbstractTimeStepper{T}</code></pre><p>A forward Euler timestepper with spectral filtering. See <a href="#FourierFlows.ForwardEulerTimeStepper"><code>ForwardEulerTimeStepper</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L121-L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredLSRK54TimeStepper" href="#FourierFlows.FilteredLSRK54TimeStepper"><code>FourierFlows.FilteredLSRK54TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredRK4TimeStepper(equation::Equation, dev::Device=CPU(); filterkwargs...)</code></pre><p>Construct a 4th-order 5-stages 2-storage Runge-Kutta timestepper with spectral filtering for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L370-L375">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredLSRK54TimeStepper" href="#FourierFlows.FilteredLSRK54TimeStepper"><code>FourierFlows.FilteredLSRK54TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FilteredLSRK54TimeStepper{T,V,Tf} &lt;: AbstractTimeStepper{T}</code></pre><p>A 4th-order 5-stages low-storage Runge-Kutta timestepper with spectral filtering. See <a href="#FourierFlows.LSRK54TimeStepper"><code>LSRK54TimeStepper</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L355-L360">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredRK4TimeStepper" href="#FourierFlows.FilteredRK4TimeStepper"><code>FourierFlows.FilteredRK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">FilteredRK4TimeStepper(equation::Equation, dev::Device=CPU(); filterkwargs...)</code></pre><p>Construct a 4th-order Runge-Kutta timestepper with spectral filtering for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L213-L217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.FilteredRK4TimeStepper" href="#FourierFlows.FilteredRK4TimeStepper"><code>FourierFlows.FilteredRK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FilteredRK4TimeStepper{T,Tf} &lt;: AbstractTimeStepper{T}</code></pre><p>A 4th-order Runge-Kutta timestepper with spectral filtering. See <a href="#FourierFlows.RK4TimeStepper"><code>RK4TimeStepper</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L199-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.ForwardEulerTimeStepper" href="#FourierFlows.ForwardEulerTimeStepper"><code>FourierFlows.ForwardEulerTimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ForwardEulerTimeStepper(equation::Equation, dev::Device=CPU())</code></pre><p>Construct a forward Euler timestepper for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L103-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.ForwardEulerTimeStepper" href="#FourierFlows.ForwardEulerTimeStepper"><code>FourierFlows.ForwardEulerTimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ForwardEulerTimeStepper{T} &lt;: AbstractTimeStepper{T}</code></pre><p>A forward Euler timestepper for time-stepping <code>∂u/∂t = RHS(u, t)</code> via:</p><pre><code class="language-julia hljs">uⁿ⁺¹ = uⁿ + dt * RHS(uⁿ, tⁿ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L89-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.LSRK54TimeStepper" href="#FourierFlows.LSRK54TimeStepper"><code>FourierFlows.LSRK54TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LSRK54TimeStepper(equation::Equation, dev::Device=CPU())</code></pre><p>Construct a 4th-order 5-stages low-storage Runge-Kutta timestepper for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L326-L330">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.LSRK54TimeStepper" href="#FourierFlows.LSRK54TimeStepper"><code>FourierFlows.LSRK54TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct LSRK54TimeStepper{T} &lt;: AbstractTimeStepper{T}</code></pre><p>A 4th-order 5-stages 2-storage Runge-Kutta timestepper for time-stepping <code>∂u/∂t = RHS(u, t)</code> via:</p><pre><code class="language-julia hljs">S² = 0

for i = 1:5
  S² = Aᵢ * S² + dt * RHS(uⁿ, t₀ + Cᵢ * dt)
  uⁿ += Bᵢ * S²
end

uⁿ⁺¹ = uⁿ</code></pre><p>where <code>Aᵢ</code>, <code>Bᵢ</code>, and <code>Cᵢ</code> are the <span>$A$</span>, <span>$B$</span>, and <span>$C$</span> coefficients from the LSRK table at the <span>$i$</span>-th stage. For details, refer to <a href="../../references/#Carpenter-Kennedy-1994">[6]</a>.</p><div class="admonition is-info"><header class="admonition-header">Usage</header><div class="admonition-body"><p>The <code>LSRK54TimeStepper</code> is <em>slower</em> than the <a href="#FourierFlows.RK4TimeStepper"><code>RK4TimeStepper</code></a> but has <em>less</em> memory footprint; half compared to <a href="#FourierFlows.RK4TimeStepper"><code>RK4TimeStepper</code></a>.</p><p>If your simulation is bound by performance then use <a href="#FourierFlows.RK4TimeStepper"><code>RK4TimeStepper</code></a>; if your simulation is bound by memory then consider using <code>LSRK54TimeStepper</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L291-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.RK4TimeStepper" href="#FourierFlows.RK4TimeStepper"><code>FourierFlows.RK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RK4TimeStepper(equation::Equation, dev::Device=CPU())</code></pre><p>Construct a 4th-order Runge-Kutta timestepper for <code>equation</code> on device <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L188-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.RK4TimeStepper" href="#FourierFlows.RK4TimeStepper"><code>FourierFlows.RK4TimeStepper</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct RK4TimeStepper{T} &lt;: AbstractTimeStepper{T}</code></pre><p>A 4th-order Runge-Kutta timestepper for time-stepping <code>∂u/∂t = RHS(u, t)</code> via:</p><pre><code class="language-julia hljs">uⁿ⁺¹ = uⁿ + dt/6 * (k₁ + 2 * k₂ + 2 * k₃ + k₄)</code></pre><p>where</p><pre><code class="language-julia hljs">k₁ = RHS(uⁿ, tⁿ)
k₂ = RHS(uⁿ + k₁ * dt/2, tⁿ + dt/2)
k₃ = RHS(uⁿ + k₂ * dt/2, tⁿ + dt/2)
k₄ = RHS(uⁿ + k₃ * dt, tⁿ + dt)</code></pre><div class="admonition is-info"><header class="admonition-header">Usage</header><div class="admonition-body"><p>If your simulation is limited by memory then consider switching to <a href="#FourierFlows.LSRK54TimeStepper"><code>LSRK54TimeStepper</code></a>. The <a href="#FourierFlows.LSRK54TimeStepper"><code>LSRK54TimeStepper</code></a> timestepper has about half the memory footprint compared to the <code>RK4TimeStepper</code> with a about 25%-30% performance trade off.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L157-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.TimeStepper" href="#FourierFlows.TimeStepper"><code>FourierFlows.TimeStepper</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">TimeStepper(stepper, equation, dt=nothing, dev=CPU(); kw...)</code></pre><p>Instantiate the Time<code>stepper</code> for <code>equation</code> with timestep <code>dt</code> and on the <code>dev</code>ice. The keyword arguments, <code>kw</code>, are passed to the timestepper constructor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L50-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.step_until!-Tuple{Any, Any}" href="#FourierFlows.step_until!-Tuple{Any, Any}"><code>FourierFlows.step_until!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">step_until!(prob, stop_time)</code></pre><p>Step forward <code>prob</code> until <code>stop_time</code>.</p><div class="admonition is-category-warn"><header class="admonition-header">Fully-explicit timestepping schemes are required</header><div class="admonition-body"><p>We cannot use <code>step_until!</code> with <a href="#FourierFlows.ETDRK4TimeStepper"><code>ETDRK4TimeStepper</code></a> nor <a href="#FourierFlows.FilteredETDRK4TimeStepper"><code>FilteredETDRK4TimeStepper</code></a>.</p></div></div><p>See also: <a href="#FourierFlows.stepforward!-Tuple{FourierFlows.Problem, Any, Int64}"><code>stepforward!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L723-L733">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.stepforward!-Tuple{FourierFlows.Problem, Any, Int64}" href="#FourierFlows.stepforward!-Tuple{FourierFlows.Problem, Any, Int64}"><code>FourierFlows.stepforward!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">stepforward!(prob::Problem, diags, nsteps::Int)</code></pre><p>Step forward <code>prob</code> for <code>nsteps</code>, incrementing <code>diags</code> along the way. <code>diags</code> may be a  single <code>Diagnostic</code> or a <code>Vector</code> of <code>Diagnostic</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L22-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.stepforward!-Tuple{FourierFlows.Problem, Int64}" href="#FourierFlows.stepforward!-Tuple{FourierFlows.Problem, Int64}"><code>FourierFlows.stepforward!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">stepforward!(prob::Problem, nsteps::Int)</code></pre><p>Step forward <code>prob</code> for <code>nsteps</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.stepforward!-Tuple{FourierFlows.Problem}" href="#FourierFlows.stepforward!-Tuple{FourierFlows.Problem}"><code>FourierFlows.stepforward!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">stepforward!(prob::Problem)</code></pre><p>Step forward <code>prob</code> one time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/timesteppers.jl#L1-L5">source</a></section></article><h2 id="Diffusion-Testbed-Module"><a class="docs-heading-anchor" href="#Diffusion-Testbed-Module">Diffusion Testbed Module</a><a id="Diffusion-Testbed-Module-1"></a><a class="docs-heading-anchor-permalink" href="#Diffusion-Testbed-Module" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Diffusion" href="#FourierFlows.Diffusion"><code>FourierFlows.Diffusion</code></a> — <span class="docstring-category">Module</span></header><section><div><p>A test-bed module that solves the 1D diffusion equation.</p><p><strong>Exports</strong></p><ul><li><a href="#FourierFlows.Diffusion.Problem"><code>Problem</code></a></li><li><a href="#FourierFlows.Diffusion.set_c!-Tuple{Any, Any}"><code>set_c!</code></a></li><li><a href="#FourierFlows.Diffusion.updatevars!-Tuple{Any, Any, Any}"><code>updatevars!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diffusion.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Diffusion.Problem" href="#FourierFlows.Diffusion.Problem"><code>FourierFlows.Diffusion.Problem</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Problem(dev::Device = CPU();
                 nx = 128,
                 Lx = 2π,
                  κ = 0,
                 dt = 0.01,
            stepper = &quot;RK4&quot;,           
   aliased_fraction = 0,
                  T = Float64)</code></pre><p>Construct a constant diffusivity problem.</p><p><strong>Keyword arguments</strong></p><ul><li><code>dev</code>: (required) <code>CPU()</code> or <code>GPU()</code>; computer architecture used to time-step <code>problem</code>.</li><li><code>nx</code>: Number of grid points in <span>$x$</span>-domain.</li><li><code>Lx</code>: Extent of the <span>$x$</span>-domain.</li><li><code>κ</code>: Diffusivity coefficient.</li><li><code>dt</code>: Time-step.</li><li><code>stepper</code>: The extent of the <span>$y$</span>-domain.</li><li><code>aliased_fraction</code>: the fraction of high-wavenubers that are zero-ed out by <code>dealias!()</code>.</li><li><code>T</code>: <code>Float64</code> or <code>Float32</code>; floating point type used for <code>problem</code> data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diffusion.jl#L21-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Diffusion.set_c!-Tuple{Any, Any}" href="#FourierFlows.Diffusion.set_c!-Tuple{Any, Any}"><code>FourierFlows.Diffusion.set_c!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_c!(prob, c)</code></pre><p>Set the solution <code>sol</code> as the transform of <code>c</code> and update <code>vars</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diffusion.jl#L162-L166">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.Diffusion.updatevars!-Tuple{Any, Any, Any}" href="#FourierFlows.Diffusion.updatevars!-Tuple{Any, Any, Any}"><code>FourierFlows.Diffusion.updatevars!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">updatevars!(vars, grid, sol)</code></pre><p>Update the variables in <code>vars</code> on the <code>grid</code> with the solution in <code>sol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/dd4a349c414ae2d854bc54ae292f8437db694b1e/src/diffusion.jl#L145-L149">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../outline/">« Contents</a><a class="docs-footer-nextpage" href="../internals/">Private »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.1 on <span class="colophon-date" title="Thursday 19 October 2023 16:49">Thursday 19 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
