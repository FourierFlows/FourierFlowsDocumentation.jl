<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Aliasing · FourierFlows.jl</title><meta name="title" content="Aliasing · FourierFlows.jl"/><meta property="og:title" content="Aliasing · FourierFlows.jl"/><meta property="twitter:title" content="Aliasing · FourierFlows.jl"/><meta name="description" content="Documentation for FourierFlows.jl."/><meta property="og:description" content="Documentation for FourierFlows.jl."/><meta property="twitter:description" content="Documentation for FourierFlows.jl."/><meta property="og:url" content="https://fourierflows.github.io/FourierFlowsDocumentation/stable/aliasing/"/><meta property="twitter:url" content="https://fourierflows.github.io/FourierFlowsDocumentation/stable/aliasing/"/><link rel="canonical" href="https://fourierflows.github.io/FourierFlowsDocumentation/stable/aliasing/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FourierFlows.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation_instructions/">Installation Instructions</a></li><li><a class="tocitem" href="../basics/">Code Basics</a></li><li><a class="tocitem" href="../grids/">Grids</a></li><li class="is-active"><a class="tocitem" href>Aliasing</a></li><li><a class="tocitem" href="../problem/">Problem</a></li><li><a class="tocitem" href="../timestepping/">Time stepping</a></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../output/">Output</a></li><li><a class="tocitem" href="../gpu/">GPU</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../literated/OneDShallowWaterGeostrophicAdjustment/">Linear rotating shallow water dynamics</a></li></ul></li><li><a class="tocitem" href="../contributing/">Contributor&#39;s guide</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline/">Contents</a></li><li><a class="tocitem" href="../library/public/">Public</a></li><li><a class="tocitem" href="../library/internals/">Private</a></li><li><a class="tocitem" href="../library/function_index/">Function index</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Aliasing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Aliasing</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/FourierFlows/FourierFlows.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/FourierFlows/FourierFlows.jl/blob/main/docs/src/aliasing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="aliasing"><a class="docs-heading-anchor" href="#aliasing">Aliasing</a><a id="aliasing-1"></a><a class="docs-heading-anchor-permalink" href="#aliasing" title="Permalink"></a></h1><p>In pseudospectral methods, when computing nonlinear terms then aliasing errors come into play.  These aliasing errors originate from the discrete nature of the grid and, specifically, the  restriction that a grid discretized with <span>$n_x$</span> points can only resolve up to <span>$n_x$</span>  wavenumbers in Fourier space. </p><p>Consider a grid with a total of <span>$n_x$</span> points. Both harmonics <span>$e^{2\pi i k x / L_x}$</span> and  <span>$e^{2\pi i (k+n_x) x / L_x}$</span>, with <span>$k$</span> an integer, are indistinguishable when evaluated on the discrete grid-points of this grid. When we compute nonlinear terms in physical space (products of various fields), we may end up with terms that project on harmonics with wavenumber beyond the maximum wavenumber that can be resolved by our grid. In that case, those wavenumbers  will be erroneously projected onto some lower wavenumber modes that fit our domain.</p><p>Take, for example, functions <span>$\cos(4x)$</span> and <span>$\cos(6x)$</span> and let&#39;s see how they are represented  on a grid <span>$x \in [-π, π)$</span> with <span>$n_x = 10$</span> grid points.</p><pre><code class="language-julia hljs">using FourierFlows, CairoMakie

nx, Lx = 10, 2π
grid = OneDGrid(; nx, Lx)

f1(x) = cos(4x)
f2(x) = cos(6x)

x = grid.x

fig = Figure()
ax = Axis(fig[1, 1], xlabel = &quot;x&quot;, limits = ((-Lx/2, Lx/2), (-1.6, 1.6)))

lines!(ax, range(-Lx/2, Lx/2, length=200), f1;
       color = (:steelblue, 0.3), label = &quot;cos(4x)&quot;)
lines!(ax, range(-Lx/2, Lx/2, length=200), f2;
       color = (:salmon, 0.3), label = &quot;cos(6x)&quot;)

scatter!(ax, x, f1.(x);
         markersize = 12, color = (:steelblue, 0.9), label = &quot;cos(4x)&quot;)
scatter!(ax, x, f2.(x);
         markersize = 24, marker = :star5, color = (:salmon, 0.9), label = &quot;cos(6x)&quot;)

axislegend(merge = true)</code></pre><img src="c4854143.svg" alt="Example block output"/><p>The take home message is that on this particular grid we cannot distinguish harmonics with  wavenumbers 4 and 6. An attempt to represent harmonics with wavenumber 6 on this grid leads to  aliasing errors. For example, say that we are solving an equation and at some point we compute  the product <span>$\cos(2x) \cos(4x)$</span>. The result should be <span>$\frac1{2} \cos(2x) + \frac1{2} \cos(6x)$</span>,  but on this grid <span>$\cos(6x)$</span> is indistinguishable from <span>$\cos(4x)$</span> and, therefore, what we compute will be indistinguishable from <span>$\frac1{2} \cos(2x) + \frac1{2} \cos(4x)$</span>!</p><p>To avoid aliasing errors we either <em>(i)</em> discard some of the wavenumber components in Fourier  space from our fields before we transform to physical space, or <em>(ii)</em> pad our fields with Fourier  components with zero power that correspond to higher wavenumbers than those resolved by the grid  before transforming to physical space. This way, the aliasing errors, which will involve the  higher wavenumbers, will be either <em>(i)</em> zero-ed out or <em>(ii)</em> only come about for wavenumbers  beyond what our grid can resolve anyway. In FourierFlows.jl, the former dealiasing scheme is  implemented.</p><div class="admonition is-info"><header class="admonition-header">De-aliasing scheme</header><div class="admonition-body"><p>FourierFlows.jl currently implements dealiasing by zeroing out the highest-<code>aliased_fraction</code>  wavenumber components on a <code>grid</code>.</p></div></div><p>The number of wavenumber components that we need to zero-out to be sure the no aliasing errors  infiltrate our solution depends on the order of the nonlinearities. For example, for quadratic  nonlinearities, one expects that we need to discard the highest-1/2 of the wavenumber components.  This way, when computing the product of two fields we won&#39;t have anything that projects onto harmonics with wavenumbers beyond those that our grid is able to resolve and, therefore, no  aliasing errors.</p><p>The above-mentioned 1/2-rule for dealiasing for quadratic nonlinearities is, however, not the  most efficient. [<a href="../references/#Orszag-1971">1</a>] pointed out that for quadratic nonlirearities, simply only discarding the highest-1/3 of wavenumber components is enough to save us from aliasing errors. To be fair, with Orszag&#39;s so-called 2/3-rule for dealiasing, still some aliasing errors occur, but those  errors only occur to the higher-1/3 wavenumber components that will be zero-ed out at the next time step, when we next dealias our solution anyway.</p><p>When constructing a <code>grid</code> we can specify the <code>aliased_fraction</code> parameter. By default, this is  set to <span>$1/3$</span>, appropriate for quadratic nonlinearities. Then <code>dealias!(fh, grid)</code> will zero-out  the highest-<code>aliased_fraction</code> wavenumber components of <code>fh</code>. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FourierFlows.dealias!" href="#FourierFlows.dealias!"><code>FourierFlows.dealias!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dealias!(fh, grid)</code></pre><p>Dealias array <code>fh</code> on the <code>grid</code> based on the <code>grids</code>&#39;s <code>aliased_fraction</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FourierFlows/FourierFlows.jl/blob/94e53a8e94d7e2042be3527956596ec6cfa66850/src/domains.jl#L423-L427">source</a></section></article><p>If we construct a grid with <code>aliased_fraction = 0</code>, e.g.,</p><pre><code class="language-julia hljs">grid_nodealias = OneDGrid(; nx, Lx, aliased_fraction=0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">OneDimensionalGrid
  ├─────────── Device: CPU
  ├──────── FloatType: Float64
  ├────────── size Lx: 6.283185307179586
  ├──── resolution nx: 10
  ├── grid spacing dx: 0.6283185307179586
  ├─────────── domain: x ∈ [-3.141592653589793, 2.5132741228718345]
  └─ aliased fraction: 0.0</code></pre><p>then <code>dealias!(fh, grid_nodealias)</code> will have <em>no effect</em> whatsoever on <code>fh</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../grids/">« Grids</a><a class="docs-footer-nextpage" href="../problem/">Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Monday 11 December 2023 08:17">Monday 11 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
