<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Aliasing · FourierFlows.jl</title><link rel="canonical" href="https://fourierflows.github.io/FourierFlowsDocumentation/dev/aliasing/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">FourierFlows.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation_instructions/">Installation Instructions</a></li><li><a class="tocitem" href="../basics/">Code Basics</a></li><li><a class="tocitem" href="../grids/">Grids</a></li><li class="is-active"><a class="tocitem" href>Aliasing</a></li><li><a class="tocitem" href="../problem/">Problem</a></li><li><a class="tocitem" href="../gpu/">GPU</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../generated/OneDShallowWaterGeostrophicAdjustment/">Linear rotating shallow water dynamics</a></li></ul></li><li><a class="tocitem" href="../contributing/">Contributor&#39;s guide</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../library/outline/">Contents</a></li><li><a class="tocitem" href="../library/public/">Public</a></li><li><a class="tocitem" href="../library/internals/">Private</a></li><li><a class="tocitem" href="../library/function_index/">Function index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Aliasing</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Aliasing</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FourierFlows/FourierFlows.jl/blob/master/docs/src/aliasing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Aliasing"><a class="docs-heading-anchor" href="#Aliasing">Aliasing</a><a id="Aliasing-1"></a><a class="docs-heading-anchor-permalink" href="#Aliasing" title="Permalink"></a></h1><p>In pseudospectral methods, when computing nonlinear terms then aliasing errors come into play.  These aliasing errors originate from the discrete nature of the grid and, specifically, with  the restriction that a grid discretized with <span>$n_x$</span> points can only resolve a total of <span>$n_x$</span>  wavenumbers in Fourier space. </p><p>On a grid with a total of <span>$n_x$</span> wavenumbers, both harmonics <span>$e^{2\pi i k x / L_x}$</span> and  <span>$e^{2\pi i (k+n_x) x / L_x}$</span>, with <span>$k$</span> an integer, are indistinguishable when evaluated on the discrete grid-points of this grid. When we compute nonlinear terms in physical space,  we may end up with terms that project on higher wavenumbers, beyond those that our grid can  represent. In that case, those wavenumbers will be erroneously projected onto some lower  wavenumber mode that fits our domain.</p><p>Take, for example, functions <span>$\cos(4x)$</span> and <span>$\cos(6x)$</span> and let&#39;s see how they are represented  on a grid <span>$x \in [-π, π)$</span> with <span>$n_x = 10$</span>.</p><pre><code class="language-julia">nx, Lx = 10, 2π
grid = OneDGrid(nx, Lx)

f1(x) = cos(4x)
f2(x) = cos(6x)

p = plot(grid.x, f1.(grid.x), lw=0, marker=:circle, c=:red, ms=8, ylims=(-1.6, 1.6), label=&quot;cos(4x)&quot;)
plot!(p, f1, lw=3, alpha=0.2, c=:red, xlims=(-Lx/2, Lx/2), label=&quot;&quot;)
plot!(p, grid.x, f2.(grid.x), lw=0, marker=:star5, ms=8.5, color=:blue, alpha=0.8, label=&quot;cos(6x)&quot;)
plot!(p, f2, lw=3, alpha=0.2, c=:blue, xlims=(-Lx/2, Lx/2), label=&quot;&quot;)

plot(p, xlabel=&quot;x&quot;, xlims=(-3.3, 3.3))</code></pre><p><img src="../assets/plot4.svg" alt/></p><p>The take home message is that on this grid we cannot distinguish harmonics of wavenumbers 4  and 6 and attempting to represent harmonics with wavenumber 6 on this grid will lead to aliasing  errors. For example, say that we are solving an equation on this grid and at some point we compute  the product <span>$\cos(2x) \cos(4x)$</span>. The result is <span>$\frac1{2} \cos(2x) + \frac1{2} \cos(6x)$</span>,  but on this grid <span>$\cos(6x)$</span> is indistinguishable from <span>$\cos(4x)$</span> and, therefore, we get an  answer which is the sum of <span>$\frac1{2} \cos(2x) + \frac1{2} \cos(4x)$</span>!</p><p>To avoid aliasing errors we either <em>(i)</em> discard some of the wavenumber components in Fourier  space from our fields before we tranform to physical space, or <em>(ii)</em> pad our fields with Fourier  components with zero power that correspond to higher wavenumbers than those resolved by the grid  before transforming to physical space. This way, the aliasing errors, which will involve the  higher wavenumbers, will be either <em>(i)</em> zero-ed out or <em>(ii)</em> only come about for wavenumbers  beyond what our grid can resolve anyway. In FourierFlows.jl, the former dealiasing scheme is  implemented.</p><div class="admonition is-info"><header class="admonition-header">De-aliasing scheme</header><div class="admonition-body"><p>FourierFlows.jl curently implements dealiasing by zeroing out the highest-<code>aliased_fraction</code>  wavenumber components on a <code>grid</code>.</p></div></div><p>The number of wavenumber components that we need to zero-out to be sure the no aliasing errors  infiltrate our solution depends on the order of the nonlinearities. For example, for quadratic  nonlinearities, one expects that we need to discard the highest-1/2 of the wavenumber components.  This way, when computing the product of two fields we won&#39;t have anything that projects onto harmonics with wavenumbers beyond those that our grid is able to resolve and, therefore, no  aliasing errors.</p><p>The above-mentioned 1/2-rule for dealiasing for quadratic nonlinearities is, however, not the  most efficient. Orszag (1972) pointed out that for quadratic nonlirearities, simply only discarding  the highest-1/3 of wavenumber components is enough to save us from aliasing errors. To be fair,  with Orszag&#39;s so-called 2/3-rule for dealiasing, still some aliasing errors occur, but those  errors only occur to the higher-1/3 wavenumber components that will be zero-ed out next time  we dealias our solution anyway.</p><p>When constructing a <code>grid</code> we can specify the <code>aliased_fraction</code> parameter. By default, this is  set to <span>$1/3$</span>, appropriate for quadratic nonlinearities. Then <code>dealias!(fh, grid)</code> will zero-out  the highest-<code>aliased_fraction</code> wavenumber components of <code>fh</code>. </p><p>If we construct a grid with <code>aliased_fraction=0</code>, e.g.,</p><pre><code class="language-julia">grid_nodealias = OneDGrid(nx, Lx; aliased_fraction=0)</code></pre><pre class="documenter-example-output">OneDimensionalGrid
  ├─────────── Device: CPU
  ├──────── FloatType: Float64
  ├────────── size Lx: 6.283185307179586
  ├──── resolution nx: 10
  ├── grid spacing dx: 0.6283185307179586
  ├─────────── domain: x ∈ [-3.141592653589793, 2.5132741228718345]
  └─ aliased fraction: 0.0</pre><p>then <code>dealias!(fh, grid_nodealias)</code> will have <em>no effect</em> whatsoever on <code>fh</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../grids/">« Grids</a><a class="docs-footer-nextpage" href="../problem/">Problem »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 4 June 2021 06:08">Friday 4 June 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
